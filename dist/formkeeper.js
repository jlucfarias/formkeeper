module.exports=function(e,t){void 0===e&&(e=void 0);var n,o,i=!0,a=new XMLHttpRequest,r=function(e){a.open("get",window.location.origin,!1),a.onreadystatechange=function(){if(200===a.status&&4===a.readyState)return!(!window.navigator.onLine||!a.responseText)},a.send()},d=function(e,t){a.open("post",e.action,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.onreadystatechange=function(){a.readyState!==XMLHttpRequest.DONE||200!==a.status||i||localStorage.removeItem(e.id)},a.send(JSON.stringify(t))},u=function(e,t){r()&&"undefined"!=typeof Storage&&(e.forEach((function(e){var t=localStorage.getItem(e.id),n=t&&JSON.parse(t);n&&d(e,n.data)})),i=!0,t&&clearTimeout(n))};void 0!==e?"string"==typeof e?o=[].concat(document.querySelector(e)):Array.isArray(e)&&(e[0]instanceof NodeList?o=e:e[0]instanceof String&&(o=e.map((function(e){return document.querySelector(e)})))):o=[].concat(document.querySelectorAll("form")),window.addEventListener("load",(function(){return u(o)})),window.addEventListener("online",(function(){return u(o)})),window.addEventListener("offline",r),o.forEach((function(e){e.addEventListener("submit",(function(a){a.preventDefault();var c={};if(e.elements.filter((function(e){return e.name&&e.value&&!e.disabled&&"file"!==e.type&&"reset"!==e.type&&"submit"!==e.type})).forEach((function(e){c[e.name]=e.value})),r())d(e,c);else{if(t&&t(),"undefined"!=typeof Storage){var f={time:(new Date).getTime(),data:c};localStorage.setItem(e.id,JSON.stringify(f))}i=!1,n=setTimeout(u,1500,o,!0)}}))}))};
